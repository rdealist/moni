# OKX（现货）连续行情：LLM 数据整合 → 规则决策 → 自动交易（MVP）

本方案目标：在 **OKX 模拟盘** 先跑通闭环：

> 数据整合（LLM）→ 信号（结构化）→ 风控与规则引擎（确定性）→ OKX 下单执行（可对账）

## 1) 参数（已确定）
- 市场：OKX 现货
- 交易对：BTC-USDT
- 周期：15m
- 策略风格：趋势
- 初始资金口径：1000 USDT（模拟）

## 2) 风险参数（推荐默认“平均值”）
适合先跑模拟盘、便于迭代：
- 单笔风险（risk_per_trade）：**0.25%**（按净值）
- 最大日亏损（max_daily_loss）：**1.0%**（触发熔断，暂停到次日）
- 最大单品种敞口（max_position_pct）：**20%**（BTC 占净值上限）
- 冷却时间（cooldown）：**15m**（每根K线最多开一次新仓/加仓）
- 止损：ATR(14) 驱动，例如 `SL = entry - 2*ATR`（趋势策略更稳）

> 后续可以根据回测/模拟结果，把 `risk_per_trade` 调到 0.1%~0.5%，把 `max_daily_loss` 调到 0.5%~2%。

## 3) 模块化设计（保证可拓展）
为了后续扩展到多交易对、多周期、多策略：

- **Data Layer**：统一输出 `MarketSnapshot`
- **LLM Layer**：输入 snapshot+摘要，输出结构化 `Signal`（方向/置信度/关键位/风险点）
- **Decision/Risk Layer**：把 Signal → `TradeIntent`（仓位、止损、熔断、冷却、滑点限制）
- **Execution Layer**：只负责 OKX API 下单/撤单/查询/对账（与策略完全解耦）
- **UI/Console**：展示信号、决策、订单、持仓、风控触发原因，支持“手动确认/一键暂停”

## 4) MVP（第一阶段）
- 只做 BTC-USDT + 15m 趋势
- 只用模拟盘
- 全量日志与审计：每次决策记录输入、LLM 输出、规则输出、下单结果

## 5) 关键原则
- LLM **不直接**输出下单参数；只输出信号与解释
- 下单必须通过确定性规则+风控
- 默认需要 **人工开关**：
  - Paper 模式（不下单）
  - Demo 模式（模拟盘下单）
  - Live 模式（实盘，需要二次确认）
